@using MainProjectNew.Models;
@model Tuple<List<Comment>, Exam>


<!doctype html>
<html lang="en-US">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <link rel="shortcut icon" href="~/heli/images/favicon.ico" />
    <title>Heli &#8211; Project Image | Creative Multi-Purpose HTML Template</title>

    <link rel="stylesheet" href="~/heli/css/bootstrap.min.css" type="text/css" media="all" />
    <link rel="stylesheet" href="~/heli/css/font-awesome.min.css" type="text/css" media="all" />
    <link rel="stylesheet" href="~/heli/css/pe-icon-7-stroke.css" type="text/css" media="all" />
    <link rel="stylesheet" href="~/heli/css/magnific-popup.css" type="text/css" media="all" />
    <link rel="stylesheet" href="~/heli/css/owl.carousel.css" type="text/css" media="all" />
    <link rel="stylesheet" href="~/heli/css/owl.theme.css" type="text/css" media="all" />
    <link rel="stylesheet" href="~/heli/css/owl.transitions.css" type="text/css" media="all" />
    <link rel="stylesheet" href="~/heli/css/prettyPhoto.css" type="text/css" media="all" />
    <link rel="stylesheet" href="~/heli/css/style.css" type="text/css" media="all" />
    <link rel="stylesheet" href="~/heli/css/custom.css" type="text/css" media="all" />
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,200i,300,300i,400,400i,600,600i,700,700i,900,900i%7CRaleway:100,200,300,400,500,600,700,800,900%7CDroid+Serif:400,400italic,700" rel="stylesheet" />
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <div class="noo-spinner">
        <div class="spinner">
            <div class="cube1"></div>
            <div class="cube2"></div>
        </div>
    </div>
    <div class="search-form-container-full">
        <div class="container">
            <div class="row">
                <div class="col-sm-7 offset-sm-3 search-wrap">
                    <div class="text-center middle">
                        <form class="search-form">
                            <input type="search" class="search-field" value="" name="s" placeholder="What are you searching for?" />
                            <button class="button-search">
                                <i class="pe-7s-search"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="side-box-container" class="sidr right">
        <div class="sidr-inner">
            <a href="#" class="button-side-box-close pe-7s-close"></a>
            <div class="side-box-inner">
                <div class="widget">
                    <h3 class="widget-title">About</h3>
                    <p>
                        Donec euismod sem ac urna finibus, sit amet efficitur erat tempus. Ut dapibus dictum turpis, vel faucibus erat posu ere vitae onec euismod sem ac urna finius sit ametvel faucibus erat posuere vitae.
                    </p>
                </div>
                <div class="widget">
                    <h3 class="widget-title">Useful Links</h3>
                    <ul>
                        <li><a href="about-us.html">About us</a></li>
                        <li><a href="portfolio.html">Portfolio</a></li>
                        <li><a href="contact-us.html">Contact us</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="blog.html">Blog</a></li>
                    </ul>
                </div>
            </div>
            <ul class="side-box-social-list">
                <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                <li><a href="#"><i class="fa fa-pinterest"></i></a></li>
                <li><a href="#"><i class="fa fa-instagram"></i></a></li>
            </ul>
        </div>
    </div>
    <div class="site">

        @RenderPage("~/Views/Shared/HorizontalMenu.cshtml")

        <div id="main">


            <div class="section bg-dark pt-9 pb-6 mb-4">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-5">
                            <div class="breadcrumb">
                                <ul class="bread_crumb">
                                    <li>@ViewBag.ExhibitionID</li>
                                </ul>
                            </div>
                            <h2 class="fz-32 mb-3 white">@Model.Item2.Student.Name</h2>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section mb-2">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-8">
                            <img class="mb-4" alt="" src="~/ExamImage/@Model.Item2.Path">
                        </div>

                        <div class="col-sm-4" style="overflow-y:scroll">
                            <div id="commentContainer">
                                @*list comment*@

                                @foreach (var item in Model.Item1)
                                {
                                    <p><span style="font-weight:bold">@item.User.UserNick: </span><span>@item.Detail</span></p>
                                }

                                @*list comment*@
                            </div>
                            <div style="margin-bottom:5px">
                                @using (Html.BeginForm("postComment", "Comment", FormMethod.Post, new { @id = "commentForm" }))
                                {
                                    <input type="text" class="" name="Detail" /><br />
                                    <input type="text" name="MainID" value="@Model.Item2.ExamID" style="display:none" />
                                    <input type="button" class="btn btn-rounded btn-dark" value="Comment" onclick="comment()" />
                                }

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            @*thong tin Photo*@

            <div class="section bg-gray pt-8 pb-8">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-8">
                            <h2 class="fz-24 mb-2">ABOUT THE PHOTO</h2>
                            <p>@Model.Item2.Quotation</p>
                            <p>@Model.Item2.Story</p>
                        </div>
                        <div class="col-sm-4">
                            <div class="portfolio-info">
                                <ul>
                                    <li><span>File:</span> @Model.Item2.Path</li>
                                    <li><span>Student:</span> @Model.Item2.Student.Name</li>
                                    <li><span>Price:</span> @Model.Item2.Price</li>
                                    <li><input class="btn btn-rounded btn-dark" type="button" value="BUY" onclick="showBuySection()" /></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            @*thong tin Photo*@




        </div>

        @RenderPage("~/Views/Shared/Footer_layout.cshtml")

    </div>

    <a id="backtotop" class="fa fa-angle-up circle" href="javascript:void(0)"></a>

    <!-- LOAD JQUERY LIBRARY -->
    <script src="~/heli/js/jquery.min.js"></script>
    <script src="~/heli/js/jquery-migrate.min.js"></script>
    <script src="~/heli/js/bootstrap.min.js"></script>
    <script src="~/heli/js/modernizr-2.7.1.min.js"></script>
    <script src="~/heli/js/jquery.sidr.min.js"></script>
    <script src="~/heli/js/jquery.countTo.js"></script>
    <script src="~/heli/js/owl.carousel.min.js"></script>
    <script src="~/heli/js/jquery.prettyPhoto.js"></script>
    <script src="~/heli/js/headroom.min.js"></script>
    <script src="~/heli/js/jQuery.headroom.js"></script>
    <script src="~/heli/js/waypoints.min.js"></script>
    <script src="~/heli/js/script.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
    <script>
        
        function comment() {
            url = "/Comments/postComment";
            $.ajax({
                type: "POST",
                url: url,
                data: $("#commentForm").serialize(),
                success: function (result) {
                    if (result == "Success") {
                        showNewComment();
                    } else {
                        alert(result);
                    }
                }
            });
            
        }

        function showNewComment()
        {
            //xoa het cac comment cu
            $("#commentContainer").find("p").each(function (index) {
                $(this).remove();
            });

            url = "/Comments/getCommentJSON/@Model.Item2.ExamID";
            $.ajax({
                type: "GET",
                url: url,
                success: function (result) {
                    var data = result["Data"];

                    for (var i = data.length - 1; i >= 0; i--) {
                        showRowComment(data[i]["Name"], data[i]["Detail"]);
                        
                    }
                }
            });

        }

        function showRowComment(name, detail)
        {
            var content = "<p><span style='font-weight:bold'>" + name + " : </span><span>" + detail + "</span></p>";
            $("#commentContainer").prepend(content);
        }
    </script>
</body>
</html>




